<% layout("/layouts/boilerplate") %>

<style>
  .listing-image {
    height: 260px;
    object-fit: cover;
  }
</style>

<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <h3 class="fw-bold mb-3 text-center">Edit Listing</h3>

      <div class="card border-0 shadow-sm rounded-4 overflow-hidden">

        <!-- CURRENT IMAGE -->
        <img
          src="<%= listing.image?.url || 'https://via.placeholder.com/800x500?text=No+Image' %>"
          class="card-img-top listing-image"
          alt="Listing image">

        <!-- FORM -->
        <div class="card-body">

          <form
            method="POST"
            action="/listings/<%= listing._id %>?_method=PUT"
            enctype="multipart/form-data"
            novalidate
            class="needs-validation"
          >

            <!-- TITLE -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Title</label>
              <input
                type="text"
                name="listing[title]"
                class="form-control"
                value="<%= listing.title %>"
                required>
            </div>

            <!-- DESCRIPTION -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Description</label>
              <textarea
                name="listing[description]"
                rows="3"
                class="form-control"
                required><%= listing.description %></textarea>
            </div>

            <!-- PRICE -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Price (â‚¹ / night)</label>
              <input
                type="number"
                name="listing[price]"
                class="form-control"
                value="<%= listing.price %>"
                min="0"
                required>
            </div>

            <!-- LOCATION -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Location</label>
              <input
                type="text"
                name="listing[location]"
                class="form-control"
                value="<%= listing.location %>"
                required>
            </div>

            <!-- COUNTRY -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Country</label>
              <input
                type="text"
                name="listing[country]"
                class="form-control"
                value="<%= listing.country %>"
                required>
            </div>

            <!-- IMAGE UPLOAD -->
            <div class="mb-4">
              <label class="form-label fw-semibold">Replace Image (optional)</label>
              <input
                type="file"
                name="image"
                class="form-control"
                accept="image/*">
            </div>

            <!-- BUTTONS -->
            <div class="d-flex gap-2">
              <button class="btn btn-dark flex-fill" type="submit">
                Save Changes
              </button>

              <a href="javascript:history.back()" class="btn btn-outline-secondary flex-fill">
                Cancel
              </a>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>
</div>